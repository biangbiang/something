配置PostgreSQL远程访问
======================

编辑数据文件夹下的pg_hba.conf文件，找到

    # TYPE  DATABASE        USER            ADDRESS                 METHOD

    # IPv4 local connections:
    host    all             all             127.0.0.1/32            md5
    host    testdb          postgres   192.1.1.2/32 md5  //新增加行

    # IPv6 local connections:
    host    all             all             ::1/128                 md5

### 新增加行说明

数据库名与用户名注意大小写，PostgreSQL是区分大小写的。 testdb->数据库名 postgres->用户名

ADDRESS 的值的格式为: IP/数值

数值取值范围为:0,8,16,24,32，即表示掩码bit的个数；

例如：

32 -> 192.168.1.1/32 表示必须是来自这个IP地址的访问才合法；

24 -> 192.168.1.0/24 表示只要来自192.168.1.0 ~ 192.168.1.255的都合法；

16 -> 192.168.0.0/16 表示只要来自192.168.0.0 ~ 192.168.255.255的都合法；

8   -> 192.0.0.0/16 表示只要来自192.0.0.0 ~ 192.255.255.255的都合法；

0   -> 0.0.0.0/0 表示全部IP地址都合法，/左边的IP地址随便了只要是合法的IP地址即可；

---

METHOD指定如何处理客户端的认证。常用的有ident，md5，password，trust，reject

dent是Linux下PostgreSQL默认的local认证方式，凡是能正确登录服务器的操作系统用户（注：不是数据库用户）就能使用本用户映射的数据库用户不需密码登录数据库。用户映射文件为`pg_ident.conf`，这个文件记录着与操作系统用户匹配的数据库用户，如果某操作系统用户在本文件中没有映射用户，则默认的映射数据库用户与操作系统用户同名。比如，服务器上有名为user1的操作系统用户，同时数据库上也有同名的数据库用户，user1登录操作系统后可以直接输入psql，以user1数据库用户身份登录数据库且不需密码。很多初学者都会遇到psql -U username登录数据库却出现“username ident 认证失败”的错误，明明数据库用户已经createuser。原因就在于此，使用了ident认证方式，却没有同名的操作系统用户或没有相应的映射用户。解决方案：1、在`pg_ident.conf`中添加映射用户；2、改变认证方式。

md5是常用的密码认证方式，如果你不使用ident，最好使用md5。密码是以md5形式传送给数据库，较安全，且不需建立同名的操作系统用户。

password是以明文密码传送给数据库，建议不要在生产环境中使用。

trust是只要知道数据库用户名就不需要密码或ident就能登录，建议不要在生产环境中使用。

reject是拒绝认证。

---

在文件查找 `listen_addresses`，他的值说明

如果希望只能从本地计算机访问PostgreSQL数据库，就将该项设置为'localhost'；

如果希望从局域网访问PostgreSQL数据库，就将该项设置为PostgreSQL数据库的局域网IP地址；

如果希望从互联网访问PostgreSQL数据库，就将该项设置为PostgreSQL数据库的互联网IP地址；

如果希望从任何地方都可以访问PostgreSQL数据库，就将该配置项设置为“*”；
